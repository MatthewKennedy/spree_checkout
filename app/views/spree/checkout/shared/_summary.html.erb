<div class="checkout-summary-container">
  <div class="d-none">
    <div class="text-start">
      <h4>
        <%= Spree.t(:order_summary) %>
      </h4>
    </div>

    <div class="text-end">
      <h4 style="margin:0; cursor: pointer;">
        <strong>
          <span><%= order.display_total.to_html %></span>
        </strong>
      </h4>
    </div>
  </div>

  <div id="checkout-summary-inner">
    <div id="cart-line-items">
      <% order.line_items.each do |item| %>
        <div class=checkout-product-image>
          <% variant = item.variant %>
          <% if variant.images.length == 0 %>
            <span class="product-thumbnail-quantity" aria-hidden="true"><%= item.quantity %></span>
            <%= product_image(variant) %>
          <% end %>
        </div>

        <div class="d-flex align-items-center">
          <div>
            <strong>
              <%= item.name %>
            </strong>
            <span class=ms-2>
              <%= item.single_money %>
            </span>
          </div>
        </div>

        <div class="d-flex align-items-center" data-hook="order_item_total">
          <div class="text-end w-100">
            <%= item.display_amount %>
          </div>
        </div>
      <% end %>
    </div>

    <% if Spree::Frontend::Config[:coupon_codes_enabled] %>
      <hr>

      <%= form_with model: @order, url: spree.checkout_apply_coupon_path do |form| %>
        <div class="d-flex" id="discount-apply">
          <div class="flex-fill">
            <div class="form-floating">
              <%= form.text_field :coupon_code, placeholder: I18n.t('spree.checkout.discount_code'), class: 'form-control' %>
              <%= form.label :coupon_code, I18n.t('spree.checkout.discount_code') %>
            </div>
          </div>

          <div>
            <%= button_tag I18n.t('spree.checkout.apply'), class: 'btn btn-secondary ms-2' %>
          </div>
        </div>
      <% end %>

      <% @order.valid_coupon_promotions.each do |promo| %>
        <%= next if promo.code == nil %>

        <span class="badge bg-dark mt-2 d-inline-flex flex-column">
          <div>
            <%= spree_checkout_svg_tag('tag.svg', class: 'me-1') %>

            <%= promo.code %>
              <%= link_to spree.checkout_remove_coupon_path(code: promo.code), data: { turbo_method: :patch }, class: 'text-reset' do %>
              <%= spree_checkout_svg_tag('close.svg', class: 'ms-2') %>
            <% end %>
          </div>
          <div>
            <small class="fw-light"><%= promo.name %></small>
          </div>
        </span>
      <% end %>

    <hr>

    <% end %>

    <div class="summary_adjustments">
      <%= render partial: "spree/checkout/shared/summary_adjustments", locals: { order: order }  %>
    </div>
  </div>
</div>
